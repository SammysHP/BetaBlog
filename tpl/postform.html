<?php
/*
    $this->htmlescape()
    $this->post
    $this->alltags
*/

function renderTextTools($element) {
    echo <<<EOT
    <div class="texttools">
        <a href="#" onClick="return makeBold(\$\$\$('$element'));"><b>B</b></a>
        <a href="#" onClick="return makeItalic(\$\$\$('$element'));"><i>I</i></a>
        <a href="#" onClick="return makeUnderline(\$\$\$('$element'));"><u>U</u></a>
        <br />
        <a href="#" onClick="return insertBreak(\$\$\$('$element'));">br</a>
        <a href="#" onClick="return insertParagraph(\$\$\$('$element'));">p</a>
        <a href="#" onClick="return makeHeading(\$\$\$('$element'));">h</a>
        <a href="#" onClick="return makeAnchor(\$\$\$('$element'));">a</a>
        <br />
        <a href="#" onClick="return makeImage(\$\$\$('$element'));">img</a>
        <a href="#" onClick="return makeImageBox(\$\$\$('$element'));">img-box</a>
        <br />
        <a href="#" onClick="return makeCode(\$\$\$('$element'));">code</a>
        <a href="#" onClick="return makeCodeBlock(\$\$\$('$element'));">code-b</a>
        <br />
        <a href="#" onClick="return escapeSelectedText(\$\$\$('$element'));">esc</a>
        <a href="#" onClick="return unescapeSelectedText(\$\$\$('$element'));">un-esc</a>
    </div>
EOT;
}

?>
<script src="<?php echo $this->baseurl; ?>js/texttools.js"></script>

<form action="" method="POST">
    <table class="table">
        <tr>
            <td class="left">Titel:</td><td><input type="text" tabindex="1" name="title" id="title" value="<?php echo $this->htmlescape($this->post->getTitle()); ?>" /></td>
        </tr>
        <tr>
            <td class="left">Datum:</td><td><input type="text" tabindex="2" name="date" value="<?php echo date("Y-m-d H:i:s", $this->post->getDate()); ?>" /></td>
        </tr>
        <tr>
            <td class="left">Ver√∂ffentlicht:</td><td><input type="checkbox" tabindex="3" style="width: auto;" name="published" <?php if ($this->post->isPublished()) echo 'checked="checked" '; ?>/></td>
        </tr>
        <tr>
            <td class="left">
                Inhalt:
                <?php renderTextTools('contenttextarea'); ?>
            </td>
            <td><textarea rows="15" tabindex="4" name="content" id="contenttextarea"><?php echo $this->htmlescape($this->post->getContent()); ?></textarea></td>
        </tr>
        <tr>
            <td class="left">
                Erweitert:
                <?php renderTextTools('extendedtextarea'); ?>
            </td>
            <td><textarea rows="30" tabindex="5" name="extended" id="extendedtextarea"><?php echo $this->htmlescape($this->post->getExtended()); ?></textarea></td>
        </tr>
        <tr>
            <td class="left">Tags:</td>
            <td>
                <input type="text" tabindex="6" name="tags" id="taginput" value="<?php echo $this->htmlescape(implode(', ', $this->post->getTags())); ?>" />
                <div class="tags"><?php
                    $tags = array();
                    foreach ($this->alltags as $tag) {
                        $tags[] = '<a href="#" onClick="return insertTag(\'' . $this->htmlescape($tag[0]) . '\');">' . $this->htmlescape($tag[0]) . '</a>';
                    }
                    echo implode(', ', $tags);
                ?></div>
            </td>
        </tr>
        <tr>
            <td class="left"></td>
            <td style="padding-top: 1em;">
                <button type="submit" tabindex="7" name="save" value="save" style="margin-right: 0.5em;">Speichern</button>
                <button type="submit" tabindex="8" name="submit" style="margin-right: 2.5em;">Absenden</button>
                <button type="button" tabindex="9" onClick="updatePreview();">Vorschau</button>
            </td>
        </tr>
    </table>
    
    <div id="preview" class="entry preview" style="display: none;"></div>
</form>
<script>
    document.getElementById('title').focus();
</script>
