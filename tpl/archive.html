<?php
/*
    $this->posts
    $this->baseurl
    $this->loggedin
*/

echo '<table id="postform" style="width: 100%;">';

foreach ($this->posts as $post) {
    echo '<tr>';
        echo '<td class="left">' . date("d.m.Y H:i", $post->getDate()) . '</td><td>';
        
        if ($this->loggedin) { ?>
        <div class="adminbox">
            <a href="<?php echo $this->baseurl . 'post/' . $post->getId() . '/edit';   ?>">bearbeiten</a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="<?php echo $this->baseurl . 'post/' . $post->getId() . '/delete'; ?>">löschen</a>
            <?php
            if (!$post->isPublished()) {
                echo '<br /><span style="color: red;">nicht veröffentlicht</span>';
            }
            ?>
        </div>
        <?php }
        
        echo '<a href="' . $this->baseurl . 'post/' . $post->getId() . '">' . $post->getTitle() . '</a>';
        echo '<div class="tags" style="text-align: left;">';
        $tags = array();
        foreach ($post->getTags() as $tag) {
            $tags[] = '<a href="' . $this->baseurl . 'tag/' . str_replace('%2F', '/', rawurlencode($tag)) . '">' . $this->htmlescape($tag) . '</a>';
        }
        echo implode(', ', $tags);
        echo '</div>';
        echo '</td>';
    echo '</tr>';
}

echo '</table>';
